{% extends "core/base.html" %}

{% block title %}Department Management{% endblock %}

{% block page_title %}Department Management{% endblock %}

{% block content %}

<div class="bg-card p-6 rounded-2xl shadow-lg border border-border mb-6 animate-fade-in-up">
  <div class="flex flex-col md:flex-row justify-between items-center gap-4">
    <div>
      <h3 class="text-lg font-semibold">All Departments</h3>
      <p class="text-sm text-muted-foreground">Add, edit, or delete departments.</p>
    </div>
    <div class="flex gap-3">
      <a 
        href="{% url 'add_department' %}" 
        class="btn-primary flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium"
      >
        <i data-lucide="plus" class="w-4 h-4"></i>
        Add Department
      </a>
    </div>
  </div>
</div>

<div class="bg-card rounded-2xl shadow-lg border border-border overflow-hidden animate-fade-in-up" style="animation-delay: 200ms;">
  <div class="overflow-x-auto">
    <table class="w-full min-w-max text-sm text-left">
      <thead class="bg-muted border-b border-border">
        <tr>
          <th class="p-4 font-medium text-muted-foreground">Department Name</th>
          <th class="p-4 font-medium text-muted-foreground">Code</th>
          <th class="p-4 font-medium text-muted-foreground">Head of Department</th>
          <th class="p-4 font-medium text-muted-foreground text-right">Actions</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-border">
        {% for dept in departments %}
        <tr class="table-row stagger-table-row">
          <td class="p-4 font-medium text-foreground">
            {{ dept.name }}
          </td>
          <td class="p-4 text-muted-foreground font-mono">{{ dept.code }}</td>
          <td class="p-4 text-muted-foreground">{{ dept.head_of_department|default:"N/A" }}</td>
          <td class="p-4 flex justify-end gap-2">
            
            <a href="{% url 'edit_department' dept.id %}" class="p-2 rounded-lg text-muted-foreground transition-all hover:bg-muted hover:text-primary hover:scale-110"><i data-lucide="edit" class="w-4 h-4"></i></a>
            
            <form method="POST" action="{% url 'delete_department' dept.id %}">
              {% csrf_token %}
              <button 
                type="submit" 
                onclick="return confirm('Are you sure you want to delete this department? This cannot be undone.');" 
                class="p-2 rounded-lg text-muted-foreground transition-all hover:bg-muted hover:text-destructive hover:scale-110">
                <i data-lucide="trash-2" class="w-4 h-4"></i>
              </button>
            </form>
            
          </td>
        </tr>
        {% empty %}
        <tr class="table-row">
            <td colspan="4" class="p-4 text-center text-muted-foreground">No departments found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <div class="p-4 border-t border-border flex items-center justify-between">
    <p class="text-sm text-muted-foreground">Showing <strong>{{ departments|length }}</strong> results</p>
  </div>
</div>

{% endblock %}